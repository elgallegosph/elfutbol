<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Torneo de F√∫tbol Pro - Gesti√≥n</title>
    <style>
        :root { 
            --primary: #1a5276; --secondary: #f4f4f4; --accent: #e74c3c; 
            --success: #27ae60; --playoff: #8e44ad; --warning: #e67e22; 
        }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--secondary); padding-bottom: 50px; }
        header { background: var(--primary); color: white; padding: 1.5rem; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .container { max-width: 1000px; margin: 10px auto; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        section { margin-bottom: 30px; border-bottom: 2px solid #eee; padding-bottom: 20px; }
        h2 { color: var(--primary); border-left: 5px solid var(--primary); padding-left: 10px; font-size: 1.4rem; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; }
        input, select, button { padding: 12px; margin: 5px 0; border: 1px solid #ccc; border-radius: 4px; width: 100%; box-sizing: border-box; font-size: 16px; }
        button { background: var(--primary); color: white; font-weight: bold; border: none; cursor: pointer; transition: 0.3s; }
        
        /* --- L√ìGICA DE VISIBILIDAD (ADMIN vs VISITANTE) --- */
        /* Cuando el body tiene esta clase, ocultamos todas las acciones de edici√≥n */
        body.modo-visitante button:not(.btn-ver-torneo):not(.btn-auth), 
        body.modo-visitante input:not(#buscadorPartidos):not(.input-auth), 
        body.modo-visitante select:not(.select-publico),
        body.modo-visitante .btn-danger,
        body.modo-visitante #seccion-privada-admin {
            display: none !important;
        }

        .lista-plantilla { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 15px; }
        .card-plantilla { border: 1px solid #ddd; padding: 10px; border-radius: 8px; background: #fff; }
        #panel-control-auth { background: #f9f9f9; padding: 20px; border-radius: 10px; border: 1px solid #ddd; margin-top: 40px; text-align: center; }
        .status-badge { display: inline-block; padding: 5px 15px; border-radius: 20px; font-weight: bold; margin-bottom: 10px; }
        .status-visitante { background: #ffebee; color: #c62828; }
        .status-admin { background: #e8f5e9; color: #2e7d32; }
    </style>
</head>
<body class="modo-visitante" id="gestorCuerpo">

<header><h1>üèÜ Gesti√≥n de Campeonato Pro</h1></header>

<div class="container">
    <section>
        <h2>üåç Torneos Disponibles</h2>
        <div id="listaTorneosPublicos" style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
            </div>
    </section>

    <section>
        <h2>1. Equipos y Plantillas</h2>
        <div class="grid">
            <div>
                <input type="text" id="nombreEquipo" placeholder="Nombre Equipo">
                <button onclick="registrarEquipo()">Registrar Equipo</button>
            </div>
            <div>
                <select id="selectEquipoJugador"></select>
                <input type="text" id="nombreJugador" placeholder="Nombre Jugador">
                <button onclick="registrarJugador()">A√±adir Jugador</button>
            </div>
        </div>
        <div id="contenedorPlantillas" class="lista-plantilla"></div>
    </section>

    <section>
        <h2>2. Sorteo y Calendario</h2>
        <input type="text" id="buscadorPartidos" placeholder="üîç Buscar equipo..." onkeyup="filtrarPartidos()">
        <button style="background: var(--success);" onclick="realizarSorteo()">üé≤ Generar Calendario</button>
        <div id="contenedorCalendario" style="margin-top:15px;"></div>
    </section>

    <section>
        <h2>3. Cargar Resultado</h2>
        <div class="grid">
            <select id="resLocal"></select>
            <input type="number" id="gLocal" placeholder="Goles Local" style="text-align:center">
            <input type="number" id="gVis" placeholder="Goles Visita" style="text-align:center">
            <select id="resVis"></select>
        </div>
        <button onclick="cargarResultadoFinal()">Cargar Resultado</button>
    </section>

    <section>
        <h2>4. Clasificaci√≥n</h2>
        <div id="contenedorTablas"></div>
    </section>

    <div id="panel-control-auth">
        <div id="auth-forms">
            <div id="badge-estado" class="status-badge status-visitante">üëÅÔ∏è Modo Espectador (Solo Lectura)</div>
            <h3>üîê Acceso Administrador</h3>
            <input type="email" id="email" class="input-auth" placeholder="Correo electr√≥nico">
            <input type="password" id="password" class="input-auth" placeholder="Contrase√±a">
            <div class="grid">
                <button onclick="login()" class="btn-auth" style="background:var(--success)">Entrar</button>
                <button onclick="register()" class="btn-auth">Registrarse</button>
            </div>
        </div>

        <div id="seccion-privada-admin" style="display:none;">
            <div class="status-badge status-admin">‚úÖ Modo Administrador Activo</div>
            <p>Puedes editar equipos, resultados y sortear el torneo.</p>
            <input type="text" id="nombreTorneo" placeholder="Nombre para guardar este torneo">
            <button onclick="crearTorneo()" style="background:var(--success)">üíæ Guardar Torneo en la Nube</button>
            <br><br>
            <button onclick="logout()" style="background:none; color:var(--accent); text-decoration:underline;">Cerrar Sesi√≥n</button>
        </div>
    </div>
</div>

<script>
    // --- L√ìGICA DE DATOS ---
    let datos = JSON.parse(localStorage.getItem('torneo_data')) || { equipos: [], partidos: [] };

    function registrarEquipo() {
        const nom = document.getElementById('nombreEquipo').value;
        if(!nom) return;
        datos.equipos.push({ nombre: nom, id: Date.now() });
        actualizarInterfaz();
    }

    function registrarJugador() {
        alert("Jugador a√±adido (L√≥gica conectada)");
        actualizarInterfaz();
    }

    function actualizarInterfaz() {
        localStorage.setItem('torneo_data', JSON.stringify(datos));
        // Aqu√≠ ir√≠an tus funciones de renderizado de tablas y selects
        console.log("Datos actualizados localmente");
    }

    // --- L√ìGICA DE SESI√ìN (ESTO CONECTA CON TU APP.JS) ---
    function alternarVistaAdmin(soyAdmin) {
        const cuerpo = document.getElementById('gestorCuerpo');
        const badge = document.getElementById('badge-estado');
        const formAuth = document.getElementById('auth-forms');
        const panelAdmin = document.getElementById('seccion-privada-admin');

        if(soyAdmin) {
            cuerpo.classList.remove('modo-visitante');
            badge.className = "status-badge status-admin";
            badge.innerText = "üöÄ Modo Administrador";
            formAuth.style.display = "none";
            panelAdmin.style.display = "block";
        } else {
            cuerpo.classList.add('modo-visitante');
            badge.className = "status-badge status-visitante";
            badge.innerText = "üëÅÔ∏è Modo Espectador (Solo Lectura)";
            formAuth.style.display = "block";
            panelAdmin.style.display = "none";
        }
    }

    // Por defecto al cargar, modo visitante
    window.onload = () => alternarVistaAdmin(false);
</script>

<script type="module" src="app.js"></script>

</body>
</html>
